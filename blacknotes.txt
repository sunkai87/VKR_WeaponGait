=== –ü—Ä–æ–µ–∫—Ç: –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –Ω–æ—à–µ–Ω–∏—è –æ—Ä—É–∂–∏—è –ø–æ –ø–æ—Ö–æ–¥–∫–µ ===

–û–±—â–∞—è —Ü–µ–ª—å:
–°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É, —Å–ø–æ—Å–æ–±–Ω—É—é –ø–æ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫—É –≤—ã—è–≤–ª—è—Ç—å –ª—é–¥–µ–π, —Å–∫—Ä—ã—Ç–æ –Ω–µ—Å—É—â–∏—Ö –æ—Ä—É–∂–∏–µ, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∏—Ö –ø–æ—Ö–æ–¥–∫–∏.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏–ø–ª–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã:

–ü–µ—Ä–≤–∞—è –≥–ª–∞–≤–∞ (–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è):

–û–±–∑–æ—Ä –º–µ—Ç–æ–¥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ö–æ–¥–∫–∏: —Å–∏–ª—É—ç—Ç–Ω—ã–µ, —Å–∫–µ–ª–µ—Ç–Ω—ã–µ, –º–µ—Ç–æ–¥—ã –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (—Å—Ç–∞—Ç—å–∏ 2020‚Äì2024 –≥–≥.).

–û–ø–∏—Å–∞–Ω–∏–µ –æ–±–ª–∞—Å—Ç–µ–π –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ø–æ—Ö–æ–¥–∫–∏.

–í—Ç–æ—Ä–∞—è –≥–ª–∞–≤–∞ (–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è):

–§–æ–∫—É—Å –Ω–∞ —Å–∫–µ–ª–µ—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö.

–í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π: HRNet, GaitGraph, FastPoseGait, SkeletonGait.

–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–µ–π –¥–ª—è –∑–∞–¥–∞—á–∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–∫—Ä—ã—Ç–æ–≥–æ –æ—Ä—É–∂–∏—è.

–¢—Ä–µ—Ç—å—è –≥–ª–∞–≤–∞ (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è):

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ª—É—á—à–µ–π –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

–ü—Ä–æ–≤–µ–¥–µ–Ω –æ–±–∑–æ—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã.

–ù–∞—Å—Ç—Ä–æ–µ–Ω HRNet:

–°–æ–∑–¥–∞–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Python 3.9, CPU-only).

–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞ –Ω–∞ CPU (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ .cuda(), —Ñ–∏–∫—Å—ã numpy –∏ multiprocessing).

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–∫—Ä–∏–ø—Ç extract_keypoints.py:

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Å—É—Å—Ç–∞–≤–æ–≤ –≤ JSON –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–¥—Ä–∞ –≤–∏–¥–µ–æ.

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

animate_skeleton.py ‚Äî –∞–Ω–∏–º–∞—Ü–∏—è —Å–∫–µ–ª–µ—Ç–∞.

overlay_pose.py ‚Äî –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —Å–∫–µ–ª–µ—Ç–∞ –Ω–∞ –∫–∞–¥—Ä—ã.

visualize_pose.py ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Å–æ —Å–∫–µ–ª–µ—Ç–æ–º.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–º–µ—â–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞–∑–º–µ—Ä –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤).

–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã:

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ GaitGraph2:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HRNet-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–∞.

–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä "—Å –æ—Ä—É–∂–∏–µ–º" / "–±–µ–∑ –æ—Ä—É–∂–∏—è".

–°–±–æ—Ä –∏ —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞:

–í—ã—Ä–µ–∑–∫–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Å–∫—Ä—ã—Ç–æ–≥–æ –Ω–æ—à–µ–Ω–∏—è –æ—Ä—É–∂–∏—è (YouTube, –∫–∞–º–µ—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, —Ñ–∏–ª—å–º—ã).

–ö–ª–∞—Å—Å—ã: 0 ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –ø–æ—Ö–æ–¥–∫–∞; 1 ‚Äî —Å–∫—Ä—ã—Ç–æ–µ –æ—Ä—É–∂–∏–µ.

–û–∫–æ–ª–æ 1200 –∫–ª–∏–ø–æ–≤ –ø–æ 5 —Å–µ–∫—É–Ω–¥.

–û–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π.

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –≤—ã–≤–æ–¥ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏.

–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:

–≠—Ç–∞–ø

–°—Ç–∞—Ç—É—Å

–û–±–∑–æ—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã

‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ HRNet

‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ keypoints

‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ö–æ–¥–∫–∏

‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö

‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ GaitGraph2

‚è≥ –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø

–û–±—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞

‚è≥

–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞:

–†–∞–±–æ—Ç–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ CPU (–Ω–æ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤ Colab).

–¶–µ–ª–µ–≤–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–æ—Ö–æ–¥–∫–∏, –∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –æ—Ä—É–∂–∏—è.

–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–¥—Ö–æ–¥ ‚Äî —Å–∫–µ–ª–µ—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã (pose-based).

–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ —Å–∏—Å—Ç–µ–º—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è.

–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

HRNet-Human-Pose-Estimation ‚Äî –¥–µ—Ç–µ–∫—Ç–∏—è —Å—É—Å—Ç–∞–≤–æ–≤.

GaitGraph2 ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Ö–æ–¥–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–µ–ª–µ—Ç–∞.

FastPoseGait, SkeletonGait ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –±—ã—Å—Ç—Ä—ã–µ —Å–∫–µ–ª–µ—Ç–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã.

OpenGait ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

–ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥—Ä—É–≥–æ–º—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é:

–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–∫—Ä—ã—Ç–æ–µ –Ω–æ—à–µ–Ω–∏–µ –æ—Ä—É–∂–∏—è, –∞ –Ω–µ –Ω–∞ –æ–±—â—É—é –ø–æ—Ö–æ–¥–∫—É.

–†–∞–±–æ—Ç–∞ –Ω–∞ CPU (–±–µ–∑ GPU).

–ö–ª—é—á–µ–≤–æ–π —ç—Ç–∞–ø —Å–µ–π—á–∞—Å ‚Äî —Å–±–æ—Ä –∏ —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å—É—Å—Ç–∞–≤–æ–≤, –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ HRNet.

–ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ ‚Äî —Å–∫–µ–ª–µ—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏, –∞ –Ω–µ —Å–∏–ª—É—ç—Ç–Ω—ã–µ.

--------------


–î–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–π —Ç–∞–∫–∏–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏, —Å–∞–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ YOLOv8, –≤–∫–ª—é—á–∞—è yolov8n-pose, —Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—É—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥—Ä–∞–∫–∏). –û–±—É—á–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é —Å –ø–æ–º–æ—â—å—é model.train(data=‚Äûcustom-pose.yaml‚Äú, epochs=100, imgsz=640) —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ –≤–∞—à custom-pose.yaml —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–æ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫ –≤–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –±–æ–ª–µ–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ –ø–æ–≤–µ—Ä—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫, —á—Ç–æ–±—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏–π –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

–ï—Å–ª–∏ –≤—ã —Ä–µ—à–∏–ª–∏ –∑–∞–Ω—è—Ç—å—Å—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∑—ã, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –º–æ–¥–µ–ª–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä RNN –∏–ª–∏ LSTM, —á—Ç–æ–±—ã –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö. –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é YOLOv8-pose –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –º–æ–≥—É—Ç –ø–æ—Å–ª—É–∂–∏—Ç—å —Ü–µ–Ω–Ω—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–º –¥–ª—è —ç—Ç–∏—Ö –º–æ–¥–µ–ª–µ–π. üöÄ



----

–ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç:

Get-ChildItem videos\*.mp4 | ForEach-Object {
    $relativePath = "videos\" + $_.Name

    if ($_.Name -match '^n') {
        $label = 'no_weapon'
    } else {
        $label = 'weapon'
    }

    "$relativePath,$label"
} | Out-File data\manifest.csv -Encoding utf8


----

–ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å mediapipe. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–Ω–æ –≤ cache/poses_mp/

# PowerShell -- –≠—Ç–æ —Å—Ä–∞–∑—É –≤—Å–µ –∏ –∑–∞–Ω–æ–≤–æ
Get-ChildItem videos\*.mp4 | % {
    python -m weapon_gait.cli extract --video $_ --backend mediapipe
}


–≠—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Ä–æ–ª–∏–∫–æ–≤ (–∑–¥–µ—Å—å –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –¥–ª—è w_...)

Get-ChildItem videos\\w_*.mp4 | Where-Object {
    -not (Test-Path ("cache\\poses_mp\\" + $_.BaseName + ".npy"))
} | ForEach-Object {
    python -m weapon_gait.cli extract --video $_ --backend mediapipe
}

----

# (A) –∏–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–∑—ã –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
python -m weapon_gait.cli extract --video videos\n_001.mp4 --backend mediapipe


# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∫—ç—à–∞ —É RF:
Remove-Item cache\\features_mediapipe_stats\\manifest.csv -ErrorAction Ignore

# (B) –æ–±—É—á–∞–µ–º RandomForest
python -m weapon_gait.cli train --manifest data\manifest.csv `
                                --pose-backend mediapipe `
                                --gait-backend stats `
                                --model runs\rf.joblib

# (C) –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–ºs
python -m weapon_gait.cli predict --video videos\n_001.mp4 --model runs\rf.joblib


Get-ChildItem videos\\w_*.mp4 | % {
    $stem = $_.BaseName
    $npy  = \"cache\\poses_movenet\\$stem.npy\"
    if (-not (Test-Path $npy)) {
        python -m weapon_gait.cli extract --video $_ --backend movenet
    }
}


Get-ChildItem videos\\w_*.mp4 | Where-Object {
    -not (Test-Path ("cache\\poses_movenet\\" + $_.BaseName + ".npy"))
} | ForEach-Object {
    python -m weapon_gait.cli extract --video $_ --backend movenet
}



----
–û–±—É—á–µ–Ω–∏–µ MoveNet
C:\Users\vkash\Desktop\JupyterWorks\VKR> python -m weapon_gait.cli train `
>>        --manifest data\manifest.csv `
>>        --pose-backend movenet `
>>        --gait-backend stats17 `
>>        --model runs\rf_movenet17.joblib

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ú—É–≤–ù–µ—Ç

python -m weapon_gait.cli predict --video videos\w_020.mp4 --model runs\rf_movenet17.joblib


---
YoloPose

# 4-a. –∏–∑–≤–ª–µ–∫–∞–µ–º
python -m weapon_gait.cli extract --video videos/w_022.mp4 --backend yolopose

# 4-b. —Ç—Ä–µ–Ω–∏—Ä—É–µ–º
python -m weapon_gait.cli train \
       --manifest data/manifest.csv \
       --pose-backend yolopose \
       --gait-backend stats17 \        # 17 —Ç–æ—á–µ–∫
       --model runs/rf_yolo17.joblib


pip uninstall -y tensorflow tensorflow-intel tensorflow-estimator tensorflow-hub tensorboard tensorboard-data-server
pip install torch==2.1.2+cpu torchvision==0.16.2+cpu -f https://download.pytorch.org/whl/torch_stable.html


---
openpifpaf

1 —Ä–æ–ª–∏–∫
python -m weapon_gait.cli extract --video videos/w_022.mp4 --backend pifpaf  


–û–±—É—á–µ–Ω–∏–µ
python -m weapon_gait.cli train \
       --manifest data/manifest.csv \
       --pose-backend pifpaf \
       --gait-backend stats17 \
       --model runs/rf_pifpaf17.joblib



–ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å cli.py

#SVM –Ω–∞ MediaPipe-Stats (+–∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è √ó3) ["rf", "svm", "nb", "logreg", "gb"]
python -m weapon_gait.cli train-ml `
       --manifest data\manifest.csv `
       --pose-backend mediapipe `
       --gait-backend stats `
       --model-key svm `
       --augment-factor 3

–ù–∞–¥–æ —Ç–∞–∫–∂–µ –º–µ–Ω—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ runs rf_stats \ svm_stats \ nb_stats \ logreg_stats \ gb_stats


–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –∫–æ–≥–¥–∞ –∑–∞–∫–∏–Ω—É–ª —Ä–æ–ª–∏–∫–∏

–ö–æ—Ä–æ—Ç–∫–∞—è –ø–∞–º—è—Ç–∫–∞ –Ω–∞ –±—É–¥—É—â–µ–µ
+ –≤–∏–¥–µ–æ ‚Üí 2. manifest ‚Üí 3. extract poses

—É–¥–∞–ª–∏—Ç—å features CSV ‚Üí 5. train-ml



–ö–∞–∫ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –¢—Ä—ç–π–Ω

python -m weapon_gait.cli train-ml `
       --manifest data\manifest.csv `
       --pose-backend mediapipe `
       --gait-backend stats `
       --model-key rf `
       --augment-factor 3 `
       --grid-search `
       --rebuild-features


---
–°–ª—É—à–∞–π, —è —Ç–∞–∫ –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ –Ω–∞–º –∫–∞–∫-–±—É–¥—Ç–æ –Ω–∞–¥–æ –Ω–µ–º–Ω–æ–∂–∫–æ –æ—Å–≤–µ–∂–∏—Ç—å—Å—è –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞—à–µ –≤–∏–¥–µ–Ω–∏–µ, 
–∫–∞–∫-—Ç–æ –±–æ–ª–µ–µ —à–∏—Ä–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞—à—É –∑–∞–¥–∞—á—É. –Ø —Å–µ–π—á–∞—Å —Ç–µ–±–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∞ —á—Ç–æ –µ—â–µ –º–æ–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤ –±—É–¥—É—â–µ–º 
–∏ —Å–µ–π—á–∞—Å –≤ –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–∞–∫ –µ–µ –º–æ–∂–Ω–æ –µ—â–µ —É–ª—É—á—à–∏—Ç—å.


–°–ª—É—à–∞–π, —Å —Ç–æ–±–æ–π –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ? –¢—ã –∏–Ω–æ–≥–¥–∞ —Ç–∞–∫–∏–µ –¥–æ–ø—É—Å–∫–∞–µ—à—å –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏, —Ç—ã –∫–∞–∫ –±—É–¥—Ç–æ –∑–∞–±—ã–ª –Ω–µ–º–Ω–æ–∂–∫–æ –∫–æ–¥,
–∫–æ—Ç–æ—Ä—ã–π –º—ã –¥–µ–ª–∞–ª–∏. –Ø –Ω–µ –∑–Ω–∞—é, –∫–∞–∫ –Ω–∞ —ç—Ç–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–æ.


| –ò–¥–µ—è                            | –ß—Ç–æ –º–µ–Ω—è–µ–º                                                       | –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å                         |
| ------------------------------- | ---------------------------------------------------------------- | ------------------------------------- |
| **GridSearchCV –¥–ª—è RF / GB**    | `n_estimators`, `max_depth`, `min_samples_leaf`, `learning_rate` | `--grid-search` (—É–∂–µ –¥–æ–±–∞–≤–∏–ª–∏)        |
| **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ *weapon*** | `--augment-factor 3`                                             | –ø–æ–¥–Ω–∏–º–µ—Ç recall –µ—â—ë –Ω–∞ 5-10 %         |
| **Ensemble** (—Å—Ç—ç–∫–∏–Ω–≥)          | –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å RF + GB + SVM                                         | –¥–æ–±–∞–≤–∏—Ç—å `StackingClassifier`         |
| **–ë–æ–ª—å—à–µ —Ñ–∏—á–µ–π**                | –¥–æ–±–∞–≤–∏—Ç—å ¬´—Ü–∏–∫–ª–æ–≤—ã–µ DCT¬ª, ¬´—à–∞–≥-—á–∞—Å—Ç–æ—Ç–∞¬ª, ¬´—Å–∏–º–º–µ—Ç—Ä–∏—é —Ä—É–∫¬ª          | —Ä–∞—Å—à–∏—Ä–∏—Ç—å `gait_features.py`          |
| **k-fold CV**                   | –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ split ‚Üí —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 5-fold                  | `cross_val_score` –∏–ª–∏ StratifiedKFold |



---
–û–±—É—á–µ–Ω–∏–µ —Å —á–∞—Å—Ç–∏—á–Ω—ã–º –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º

python -m weapon_gait.cli train-ml `
       --manifest data\manifest.csv `
       --pose-backend mediapipe `
       --gait-backend statsparts `
       --model-key gb `
       --augment-factor 3 `
       --grid-search `
       --rebuild-features


python -m weapon_gait.cli train-ml `
       --manifest data\manifest.csv `
       --pose-backend mediapipe `
       --gait-backend statsplus `
       --model-key gb `
       --augment-factor 3 `
       --grid-search `
       --kfold 5 `
       --rebuild-features `
       --plots